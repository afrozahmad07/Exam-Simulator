{% extends "base.html" %}

{% block title %}Upload Materials - Exam Simulator{% endblock %}

{% block content %}
<div class="container">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="display-6 mb-2">
                <i class="bi bi-cloud-upload-fill text-primary me-2"></i>
                Upload Study Materials
            </h1>
            <p class="text-muted">Upload your documents to generate AI-powered practice exams</p>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-body p-4">
                    <h5 class="card-title mb-4">
                        <i class="bi bi-file-earmark-arrow-up me-2"></i>
                        Upload Document
                    </h5>

                    <form method="POST" action="{{ url_for('upload') }}" enctype="multipart/form-data"
                          x-data="{ fileName: '', fileSize: '', uploading: false }"
                          @submit="uploading = true">

                        <div class="mb-4">
                            <label for="file" class="form-label fw-bold">
                                Select File
                                <span class="text-danger">*</span>
                            </label>
                            <input type="file"
                                   class="form-control form-control-lg"
                                   id="file"
                                   name="file"
                                   accept=".pdf,.docx,.txt"
                                   required
                                   @change="fileName = $event.target.files[0]?.name || ''; fileSize = ($event.target.files[0]?.size / 1024 / 1024).toFixed(2) + ' MB'">
                            <div class="form-text">
                                <i class="bi bi-info-circle me-1"></i>
                                Supported formats: PDF, DOCX, TXT (Max 16MB)
                                <br>
                                <small class="text-muted">Large PDFs may take 30-60 seconds to process</small>
                            </div>
                            <div x-show="fileName" class="mt-2">
                                <small class="text-success">
                                    <i class="bi bi-check-circle me-1"></i>
                                    Selected: <strong x-text="fileName"></strong> (<span x-text="fileSize"></span>)
                                </small>
                            </div>
                        </div>

                        <div class="d-grid">
                            <button type="submit"
                                    class="btn btn-primary btn-lg"
                                    :disabled="uploading || !fileName">
                                <span x-show="!uploading">
                                    <i class="bi bi-cloud-upload me-2"></i>
                                    Upload Document
                                </span>
                                <span x-show="uploading">
                                    <span class="spinner-border spinner-border-sm me-2"></span>
                                    Processing... Please wait
                                </span>
                            </button>
                        </div>

                        <!-- Processing notice -->
                        <div x-show="uploading" class="alert alert-info mt-3">
                            <i class="bi bi-hourglass-split me-2"></i>
                            <strong>Processing your document...</strong>
                            <br>
                            <small>This may take up to a minute for large files. Please don't close this page.</small>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="card border-0 bg-light">
                <div class="card-body">
                    <h6 class="card-title mb-3">
                        <i class="bi bi-lightbulb me-2"></i>
                        Tips for Better Results
                    </h6>
                    <ul class="small text-muted mb-0">
                        <li class="mb-2">Upload clear, well-formatted documents</li>
                        <li class="mb-2">Longer documents generate more questions</li>
                        <li class="mb-2">PDF and DOCX formats work best</li>
                        <li class="mb-2">Ensure text is searchable (not scanned images)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
